```{r, include=FALSE}
library(ggplot2)
library(ggmap)
library(grid)
library(dplyr)
library(reshape2)
library(ggtern)
if(!exists('ROOT')) ROOT = getwd()
load(sprintf('%s/data/clean_data.RData', ROOT))
```

```{r}
df = (df.coda <- data %>% select(x, y, Ca, Mg, Na)) %>% mutate(
  'clrCa' = log(Ca/(Ca*Mg*Na)^(1/3)),
  'clrMg' = log(Mg/(Ca*Mg*Na)^(1/3)),
  'clrNa' = log(Na/(Ca*Mg*Na)^(1/3))) %>% select(x, y, clrCa, clrMg, clrNa) %>% melt(id.vars = c('x', 'y'))
```

```{r, fig.width=10, fig.height=10, warning=FALSE}
ggmap(map) + 
  geom_point(data = df, aes(x = x, y = y, color=value), size=4,  alpha = .75) +
  xlab(NULL) + ylab(NULL) + facet_wrap(~variable, nrow=2) +
  theme(axis.ticks = element_blank(), axis.text = element_blank())
```

```{r}
ggtern(data = df.coda, aes(x=Ca, Mg, Na)) + geom_point()
```